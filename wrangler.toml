name = "pixieblooms"
compatibility_date = "2024-01-01"
pages_build_output_dir = "dist"

# ⚠️ IMPORTANT: wrangler.toml is the SOURCE OF TRUTH
#
# The dashboard message "Bindings managed through wrangler.toml" is CORRECT.
# You CANNOT add bindings manually in the dashboard when using wrangler.toml.
#
# These bindings WILL be applied automatically on your next deployment.
#
# Required setup:
# 1. Create R2 bucket named "pixie-blooms-images" in your Cloudflare R2 dashboard
# 2. Analytics Engine is enabled by default
# 3. Push this file to git - bindings apply automatically
# 
# OPTIMIZATION NOTE:
# - KV is no longer used for traffic tracking (migrated to in-memory cache + Analytics Engine)
# - This reduces costs and improves performance significantly
# - Traffic metrics are still available via Analytics Engine for historical analysis

[[r2_buckets]]
binding = "R2_BUCKET"
bucket_name = "pixie-blooms-images"
preview_bucket_name = "pixie-blooms-images"

# Analytics Engine binding for high-volume traffic tracking
[[analytics_engine_datasets]]
binding = "TRAFFIC_ANALYTICS"

# Local development environment variables
[vars]
RAZORPAY_KEY_ID = "rzp_live_RsbDbcZ82rrFGa"
RAZORPAY_KEY_SECRET = "8ZyU7s80bLjjroAUkeu3COj6"
CLOUDFLARE_ACCOUNT_ID = "06733e3098d1ab1474045b028939f839"
CLOUDFLARE_ANALYTICS_TOKEN = "8LxUm7_Bu8oZPq0qjMZdACpJeCNxtgasw8OOv0PR"

# Production environment
[env.production]

[[env.production.r2_buckets]]
binding = "R2_BUCKET"
bucket_name = "pixie-blooms-images"

[[env.production.analytics_engine_datasets]]
binding = "TRAFFIC_ANALYTICS"

[env.production.vars]
RAZORPAY_KEY_ID = "rzp_live_RsbDbcZ82rrFGa"
RAZORPAY_KEY_SECRET = "8ZyU7s80bLjjroAUkeu3COj6"
CLOUDFLARE_ACCOUNT_ID = "06733e3098d1ab1474045b028939f839"
CLOUDFLARE_ANALYTICS_TOKEN = "8LxUm7_Bu8oZPq0qjMZdACpJeCNxtgasw8OOv0PR"

# Preview environment
[env.preview]

[[env.preview.r2_buckets]]
binding = "R2_BUCKET"
bucket_name = "pixie-blooms-images"

[[env.preview.analytics_engine_datasets]]
binding = "TRAFFIC_ANALYTICS"

[env.preview.vars]
RAZORPAY_KEY_ID = "rzp_live_RsbDbcZ82rrFGa"
RAZORPAY_KEY_SECRET = "8ZyU7s80bLjjroAUkeu3COj6"
CLOUDFLARE_ACCOUNT_ID = "06733e3098d1ab1474045b028939f839"
CLOUDFLARE_ANALYTICS_TOKEN = "8LxUm7_Bu8oZPq0qjMZdACpJeCNxtgasw8OOv0PR"
